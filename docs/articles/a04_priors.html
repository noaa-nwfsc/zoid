<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prior sensitivity for overdispersion • zoid</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Prior sensitivity for overdispersion">
<meta property="og:description" content="zoid">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">zoid</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_fitting.html">Fitting models with zoid</a>
    </li>
    <li>
      <a href="../articles/a02_simulating.html">Simulating data</a>
    </li>
    <li>
      <a href="../articles/a03_beta_priors.html">Priors for compositions</a>
    </li>
    <li>
      <a href="../articles/a04_priors.html">Prior sensitivity for overdispersion</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/noaa-nwfsc/zoid/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Prior sensitivity for overdispersion</h1>
                        <h4 data-toc-skip class="author"></h4>
            
            <h4 data-toc-skip class="date">2024-01-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/noaa-nwfsc/zoid/blob/HEAD/vignettes/a04_priors.Rmd" class="external-link"><code>vignettes/a04_priors.Rmd</code></a></small>
      <div class="hidden name"><code>a04_priors.Rmd</code></div>

    </div>

    
    
<p>Let’s load the necessary packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://noaa-nwfsc.github.io/zoid/" class="external-link">zoid</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette is designed to illustrate the interaction between the
units that responses are measured on, and the scale of the prior
distribution on overdispersion, <span class="math inline">\(\phi\)</span>.</p>
<div class="section level2">
<h2 id="fish-stomach-contents-example">Fish stomach contents example<a class="anchor" aria-label="anchor" href="#fish-stomach-contents-example"></a>
</h2>
<p>We will demonstrate this sensitivity with the cod stomach contents
data included with the package. The original units reported are in grams
(so numbers in each cell are up to several thousand).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">coddiet</span><span class="op">)</span></span>
<span><span class="va">data_matrix</span> <span class="op">=</span> <span class="va">coddiet</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coddiet</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Year"</span>,<span class="st">"Season"</span><span class="op">)</span><span class="op">==</span><span class="cn">FALSE</span><span class="op">]</span></span></code></pre></div>
<p>We’ll ignore the important covariates (year, season) and just treat
all observations (rows) as replicates.</p>
<p>The overdispersion parameter <span class="math inline">\(\phi\)</span> is assigned a prior so that <span class="math inline">\(1/\phi \sim Cauchy(0,\sigma)\)</span> where <span class="math inline">\(\sigma\)</span> represents the scale parameter.
Because <span class="math inline">\(\phi\)</span> has to be positive,
this prior is also assigned a lower bound of 0 (half-Cauchy).</p>
<p>Using our cod diet data, we can fit the model with several different
values of the prior scale, and look at the prior versus posterior draws
for <span class="math inline">\(\phi\)</span>. First, we’ll use the
default prior of <span class="math inline">\(\sigma=5\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">fit_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_zoid.html">fit_zoid</a></span><span class="op">(</span>data_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data_matrix</span><span class="op">)</span>,</span>
<span>                      overdispersion <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      overdispersion_sd <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                      chains<span class="op">=</span><span class="fl">1</span>,</span>
<span>                      iter<span class="op">=</span><span class="va">mcmc_iter</span>, refresh<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>Now we can compare the prior and posterior distributions; because
these are skewed, we’ll show them in log-space.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"value"</span> <span class="op">=</span> <span class="va">fit_1</span><span class="op">$</span><span class="va">overdispersion_prior</span>,</span>
<span>                   <span class="st">"dist"</span><span class="op">=</span><span class="st">"prior"</span><span class="op">)</span></span>
<span><span class="va">post</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"value"</span> <span class="op">=</span> <span class="fu">rstan</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-method-extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">$</span><span class="va">model</span>,<span class="st">"phi"</span><span class="op">)</span><span class="op">$</span><span class="va">phi</span>,</span>
<span>                  <span class="st">"dist"</span><span class="op">=</span><span class="st">"post"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">$</span><span class="va">overdispersion_prior</span><span class="op">)</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>,<span class="fl">20</span>,length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1000</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Posterior (pink) and prior (blue)"</span>, xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu">rstan</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-method-extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">$</span><span class="va">model</span>,<span class="st">"phi"</span><span class="op">)</span><span class="op">$</span><span class="va">phi</span><span class="op">)</span>,breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>,<span class="fl">20</span>,length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="a04_priors_files/figure-html/unnamed-chunk-4-1.png" width="528"></p>
<p>Next we can try re-fitting the model with a lot more informative
(smaller) value of <span class="math inline">\(\sigma\)</span>. We can
calculate the percent overlap across each iteration to quantify
similarity between prior and posterior.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"sd"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.001</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>,length.out<span class="op">=</span><span class="va">length_out</span><span class="op">)</span><span class="op">)</span>,overlap<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fit_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_zoid.html">fit_zoid</a></span><span class="op">(</span>data_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data_matrix</span><span class="op">)</span>,</span>
<span>                      overdispersion <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      overdispersion_sd <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                      chains<span class="op">=</span><span class="fl">1</span>,</span>
<span>                      iter<span class="op">=</span><span class="va">mcmc_iter</span>, refresh<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">$</span><span class="va">overdispersion_prior</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu">rstan</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-method-extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">$</span><span class="va">model</span>,<span class="st">"phi"</span><span class="op">)</span><span class="op">$</span><span class="va">phi</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">$</span><span class="va">overdispersion_prior</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">sd</span>,<span class="va">df</span><span class="op">$</span><span class="va">overlap</span>, xlab<span class="op">=</span><span class="st">"Prior SD"</span>, ylab<span class="op">=</span><span class="st">"% Overlap"</span>,main<span class="op">=</span><span class="st">"Data units: grams"</span>,type<span class="op">=</span><span class="st">"b"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a04_priors_files/figure-html/unnamed-chunk-6-1.png" width="528"></p>
<p>As a sensitivity, we will change the units of the original data from
grams to kilograms.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_matrix</span> <span class="op">=</span> <span class="va">data_matrix</span> <span class="op">/</span> <span class="fl">1000</span></span></code></pre></div>
<p>Now, we repeat the sensitivity as a function of the prior scale <span class="math inline">\(\sigma\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"sd"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.001</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,length.out<span class="op">=</span><span class="va">length_out</span><span class="op">)</span><span class="op">)</span>,overlap<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fit_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_zoid.html">fit_zoid</a></span><span class="op">(</span>data_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data_matrix</span><span class="op">)</span>,</span>
<span>                      overdispersion <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      overdispersion_sd <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                      chains<span class="op">=</span><span class="fl">1</span>,</span>
<span>                      iter<span class="op">=</span><span class="va">mcmc_iter</span>, refresh<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">$</span><span class="va">overdispersion_prior</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu">rstan</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-method-extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">$</span><span class="va">model</span>,<span class="st">"phi"</span><span class="op">)</span><span class="op">$</span><span class="va">phi</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">$</span><span class="va">overdispersion_prior</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">sd</span>,<span class="va">df</span><span class="op">$</span><span class="va">overlap</span>, xlab<span class="op">=</span><span class="st">"Prior SD"</span>, ylab<span class="op">=</span><span class="st">"% Overlap"</span>,main<span class="op">=</span><span class="st">"Data units: kilograms"</span>,type<span class="op">=</span><span class="st">"b"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a04_priors_files/figure-html/unnamed-chunk-9-1.png" width="528"></p>
</div>
<div class="section level2">
<h2 id="does-scale-of-the-data-impact-precision-of-the-posterior-estimates">Does scale of the data impact precision of the posterior
estimates?<a class="anchor" aria-label="anchor" href="#does-scale-of-the-data-impact-precision-of-the-posterior-estimates"></a>
</h2>
<p>To answer whether rescaling the data has any impact on parameters
other than overdispersion, we can compare the model fit in grams to that
fit with kg. We find no differences between the point estimates of
proportions or uncertainty intervals.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"coddiet"</span><span class="op">)</span></span>
<span><span class="va">data_matrix</span> <span class="op">=</span> <span class="va">coddiet</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coddiet</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Year"</span>,<span class="st">"Season"</span><span class="op">)</span><span class="op">==</span><span class="cn">FALSE</span><span class="op">]</span></span>
<span></span>
<span><span class="va">fit_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_zoid.html">fit_zoid</a></span><span class="op">(</span>data_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data_matrix</span><span class="op">)</span>,</span>
<span>                      overdispersion <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      overdispersion_sd <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                      chains<span class="op">=</span><span class="fl">1</span>,</span>
<span>                      iter<span class="op">=</span><span class="va">mcmc_iter</span>, refresh<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">fit_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_zoid.html">fit_zoid</a></span><span class="op">(</span>data_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data_matrix</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span>                      overdispersion <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      overdispersion_sd <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                      chains<span class="op">=</span><span class="fl">1</span>,</span>
<span>                      iter<span class="op">=</span><span class="va">mcmc_iter</span>, refresh<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pars_g</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_fitted.html">get_fitted</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">)</span></span>
<span><span class="va">pars_kg</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_fitted.html">get_fitted</a></span><span class="op">(</span><span class="va">fit_2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pars_g</span><span class="op">$</span><span class="va">hi</span><span class="op">-</span><span class="va">pars_g</span><span class="op">$</span><span class="va">lo</span>, <span class="va">pars_kg</span><span class="op">$</span><span class="va">hi</span><span class="op">-</span><span class="va">pars_kg</span><span class="op">$</span><span class="va">lo</span>,main<span class="op">=</span><span class="st">""</span>,xlab<span class="op">=</span><span class="st">"95% CI width (g)"</span>, ylab<span class="op">=</span><span class="st">"95% CI width (kg)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a04_priors_files/figure-html/unnamed-chunk-11-1.png" width="528"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Eric J. Ward, Alexander J. Jensen, Ryan P. Kelly, Andrew O. Shelton, William H. Satterthwaite, Eric C. Anderson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
